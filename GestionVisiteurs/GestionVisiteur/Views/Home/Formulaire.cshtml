
@{
    ViewBag.Title = "Formulaire";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var tabList = [].slice.call(document.querySelectorAll("#myTab a"));
        tabList.forEach(function (tab) {
            var tabTrigger = new bootstrap.Tab(tab);

            tab.addEventListener("click", function (event) {
                event.preventDefault();
                tabTrigger.show();
            });
        });
    });
</script>

<h2>Formulaire</h2>

<ul class="nav nav-tabs" id="myTab">
    <li class="nav-item">
        <a href="#home" class="nav-link active">Journal des visites</a>
    </li>
    <li class="nav-item">
        <a href="#profile" class="nav-link">Liste des RDV</a>
    </li>
</ul>

<!-- ============================================================== -->
<!-- Contenu du Navbar  -->
<!-- ============================================================== -->

<div class="tab-content">
    <div class="tab-pane fade show active" id="home">
        <div class="card">
            <div class="card-body">
                <div class="form-group text-center">
                    <!-- Button to Open the Modal -->
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalEnregistrement">
                        <i class="fa fa-plus"> Ajouter</i>
                    </button>

                </div>
                <!-- ============================================================== -->
                <!-- Affichage modal  enregistrer visite  -->
                <!-- ============================================================== -->
                <!-- The Modal -->
                <div class="modal" id="modalEnregistrement">
                    <div class="modal-dialog modal-dialog-centered modal-xl">
                        <div class="modal-content">

                            <!-- Modal Header -->
                            <div class="modal-header">
                                <h4 class="modal-title">Enregistrer une Visite</h4>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>

                            <!-- Modal body -->
                            <div class="modal-body">


                                <div class="container">
                                    <!--FORMULAIRE-->
                                    <form name="formVisiteur" id="formVisiteur" method="post" action="">

                                        <div class="row">
                                            <div class="form-group col-xs-6 col-sm-6 col-md-3 col-lg-3 col-xl-3 text-end">
                                                <label for="TYPE_VISITEUR">Type de visiteur</label>
                                            </div>
                                            <div class="form-group col-xs-12 col-sm-12 col-md-9 col-lg-6 col-xl-6">
                                                <select style="max-width:100%" class="form-select" name="TYPE_VISITEUR" id="TYPE_VISITEUR">
                                                    <option value="CNI">Visiteur</option>
                                                    <option value="PARTICIPANT">Participant à une formation</option>
                                                    <option value="LIVREUR">Livreur</option>
                                                    <option value="PRESTATAIRE_SERVICE">Prestateur de service</option>
                                                    <option value="AGENT_BNETD">Agent BNETD</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="row m-2">
                                            <div class="col-lg-6 col-sm-6 col-xs-4 col-md-4 col-xl-4">
                                                <div class="form-outline">
                                                    <label for="NOM_VISITEUR">* Nom </label>
                                                    <input style="max-width:100%" type="text" class="form-control" id="NOM_VISITEUR" name="NOM_VISITEUR" placeholder="Nom" required>

                                                </div>
                                            </div>



                                            <div class=" col-lg-6 col-sm-6 col-xs-4 col-md-4 col-xl-4">
                                                <label for="PRENOMS">* Prenoms</label>
                                                <input style="max-width:100%" type="text" class="form-control" id="PRENOMS" name="PRENOMS" placeholder="Prenoms" required>
                                            </div>

                                        </div>
                                        <div class="row m-2">

                                            <div class=" col-lg-6 col-sm-6 col-xs-4 col-md-4 col-xl-4">
                                                <label for="AGENT_VISITE">Agent visité</label>
                                                <select style="max-width:100%" class="form-select" name="AGENT_VISITE" id="AGENT_VISITE">
                                                    <option value=""></option>

                                                </select>
                                            </div>




                                            <div class="col-lg-6 col-sm-6 col-xs-4 col-md-4 col-xl-4">
                                                <label for="MOTIF">Motif de visite</label>
                                                <select style="max-width:100%" class="form-select" id="MOTIF" name="MOTIF">
                                                    <option value=""></option>
                                                </select>
                                            </div>

                                        </div>
                                        <div class="row m-2">
                                            <div class=" col-lg-6 col-sm-6 col-xs-4 col-md-4 col-xl-4">
                                                <label for="TYPE_PIECE">Type de pièce</label>
                                                <select style="max-width:100%" class="form-select" name="TYPE_PIECE" id=" TYPE_PIECE ">
                                                    <option value="CNI">CNI</option>
                                                    <option value="Passport">Passport</option>
                                                    <option value="F">Permis de conduire</option>
                                                </select>
                                            </div>

                                            <div class=" col-lg-6 col-sm-6 col-xs-4 col-md-4 col-xl-4">
                                                <label for="NUMRO_PIECE">N° piéce </label>
                                                <input style="max-width:100%" type="text" class="form-control" id="NUMRO_PIECE" name="NUMRO_PIECE" placeholder="Numéro...">
                                            </div>

                                        </div>

                                        <div class="row m-2">
                                            <div class=" col-lg-6 col-sm-6 col-xs-4 col-md-4 col-xl-4">
                                                <label for="NUMERO_BADGE">N° badge</label>
                                                <select style="max-width:100%" class="form-select" name="NUMERO_BADGE" id="NUMERO_BADGE">
                                                    <option value=""></option>

                                                </select>
                                            </div>



                                            <div class=" col-lg-6 col-sm-6 col-xs-4 col-md-4 col-xl-4">
                                                <label for="CONTACTE">Contacte</label>
                                                <input style="max-width:100%" type="text" class="form-control" id="CONTACTE" name="CONTACTE" placeholder="Contact...">
                                            </div>
                                        </div>

                                        <div class="row m-2">
                                            <div class=" col-lg-6 col-sm-6 col-xs-4 col-md-4 col-xl-4">
                                                <label for="date1">Date</label>
                                                <input style="max-width:100%" id="date1" class="form-control" type="date">
                                            </div>




                                            <div class=" col-lg-6 col-sm-6 col-xs-9 col-md-6 col-xl-6">
                                                <label for="myTime1">Heure d'entrée</label>
                                                <input style="max-width:100%" id="myTime1" class="form-control" type="time">
                                            </div>
                                        </div>

                                        <div class="row m-2">
                                            @*<div class=" col-lg-6 col-sm-6 col-xs-9 col-md-6 col-xl-6">
                                                    <label for="myTime2">Heure de sortie</label>
                                                    <input style="max-width:100%" id="myTime2" class="form-control" type="time">
                                                </div>*@


                                            <div class=" col-xs-9 col-sm-9 col-md-9 col-lg-5 col-xl-5">
                                                <label for=""><span class="text-danger"></span>Objets déclarés</label>
                                                <textarea style="max-width:100%" class="form-control" id="PBC_LIBELLE_" name="PBC_LIBELLE_"></textarea>
                                            </div>


                                            <div class=" col-xs-3 col-sm-3 col-md-1 col-lg-2 col-xl-2">
                                                <button class="btn btn-primary btn-sm add" id="btn" style="margin-top:30px" title="Cliquez pour Ajouter un nouvel objet">
                                                    <i class="fa fa-plus"></i>
                                                </button>

                                                <button class="btn btn-danger btn-sm delete" type="button" style="margin-top:30px" title="Cliquez pour Supprimer une ligne">
                                                    <i class="fa fa-trash"></i>
                                                </button>
                                            </div>

                                            <table class="table Listeobjet" id="table1">
                                                <thead>
                                                    <tr>
                                                        <th>Objet(s) declaré(s)</th>
                                                        <th>Sélectionner</th>
                                                    </tr>
                                                </thead>
                                                <tbody></tbody>
                                            </table>

                                        </div>


                                        <script>
                                            $(document).ready(function () {
                                                $(".add").click(function () {
                                                    var nom = $("#PBC_LIBELLE_").val();
                                                    //var email = $("#email_").val();
                                                    //var ligne = "<tr><td><input readonly='readonly' Name='Name' value=" + nom + "></td><td style='text-align:center'><input type='checkbox' name='select'></td></tr>";
                                                    var ligne = "<tr><td style='width:75%'><textarea style='width:100%' readonly='readonly' Name='PBC_LIBELLE'>" + nom + "</textarea></td><td style='width:25%; text-align:center'><input type='checkbox' name='select'></td></tr>";
                                                    //var ligne = "<tr><td style='width:75%'><textarea style='width:100%' readonly='readonly' Name='PBC_LIBELLE'>" + nom + "</textarea></td><td style='width:25%; text-align:center'><button class='btn btn-danger btn-xs delete' type='button'><i class='fa fa-trash-o'></i></button></td></tr>";
                                                    $("table.ListeProblemes").append(ligne);

                                                    //Vider le textarea
                                                    $('#PBC_LIBELLE_').val('');

                                                    //Griser le button
                                                    $('button[id="btn"]').attr('disabled', true);
                                                });

                                                $(".delete").click(function () {
                                                    $("table.ListeProblemes").find('input[name="select"]').each(function () {
                                                        //alert(1);
                                                        if ($(this).is(":checked")) {
                                                            $(this).parents("table.ListeProblemes tr").remove();
                                                        }
                                                    });
                                                });
                                            });


                                            //Code de Activation/Désactivation du bouton d'ajout de ligne si le textarea est vide ou pas
                                            $(document).ready(function () {
                                                $('button[id="btn"]').attr('disabled', true);
                                                $('textarea').on('keyup', function () {
                                                    var textarea_value = $("#PBC_LIBELLE").val();
                                                    //alert(textarea_value);
                                                    if (textarea_value != '') {
                                                        //alert('false');
                                                        $('button[id="btn"]').attr('disabled', false);
                                                    } else {
                                                        //alert('true');
                                                        $('button[id="btn"]').attr('disabled', true);
                                                    }
                                                });
                                            });
                                        </script>



                                        <div class="form-group text-center">
                                            <button type="button" class="btn btn-primary">
                                                <span class="btn-label"><i class="fa fa-save"></i></span>Enregistrer
                                            </button>

                                        </div>

                                    </form>
                                    <!--FIN FORMULAIRE-->

                                </div>



                            </div>

                            <!-- Modal footer -->
                            <div class="modal-footer">
                                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Annuler</button>
                            </div>

                        </div>
                    </div>
                </div>

                <!--Affiche les données-->
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title" style="background-color:#008080; color:#ffffff">Liste des visites</h4>
                        <div class="table-responsive">
                            <table id="zero_config" class="table table-striped table-bordered">
                                <thead>
                                    <tr>
                                        <th>N°</th>
                                        <th>Date</th>
                                        <th>Visiteur</th>
                                        <th>Agent</th>
                                        <th>Contact</th>
                                        <th>Motif</th>
                                        <th>Heure d'entrée</th>
                                        <th>Heur de sortie</th>
                                        <th>Statut</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tr>
                                    <th>...</th>
                                    <th>...</th>
                                    <th>....</th>
                                    <th>...</th>
                                    <th>...</th>
                                    <th>...</th>
                                    <th>...</th>
                                    <th>...</th>
                                    <th>...</th>
                                    <th style="width:auto">
                                        <div class="btn-group dropend">
                                            <button type="button" class="btn btn-warning dropdown-toggle" data-bs-toggle="dropdown">
                                                <i class="mdi mdi-menu font-15"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><a class="dropdown-item" href="#">Detail</a></li>
                                                <li><a class="dropdown-item" href="#">Modifier</a></li>
                                                <li><a class="dropdown-item" href="#">Suprimer</a></li>
                                            </ul>
                                        </div>


                                    </th>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>
            <div class="tab-pane fade" id="profile">

                <div class="tab-pane fade show active" id="home">
                    <div class="card">
                        <div class="card-body">
                            @RenderPage("~/views/creerrdv/enregistrerrdv.cshtml")
                            
                        </div>
                    </div>
                </div>
            </div>            
</div>
